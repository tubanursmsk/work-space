<div class="row">
  <div class="col-12">
    <h2 class="my-4 text-center text-white">Ürün Listesi</h2>

    @if (isLoading()) {
      <div class="text-center my-5">
        <div class="spinner-border text-success" role="status">
          <span class="visually-hidden">Yükleniyor...</span>
        </div>
        <p class="text-success">Ürünler yükleniyor...</p>
      </div>
    } @else if (!isLoading() && products().length === 0) {
      <div class="alert alert-warning text-center">Hiç ürün bulunamadı.</div>
    } @else {
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        @for (product of products(); track product.id) {
          <div class="col">
            <a
              [routerLink]="['/products', product.id]"
              class="card h-100 shadow-sm text-decoration-none d-block product-card-link"
            >
              <img
                [src]="product.thumbnail"
                class="card-img-top"
                alt="{{ product.title }}"
                width="200"
                height="200"
                loading="lazy"
              />
              <div class="card-body">
                <h5 class="card-title text-success">{{ product.title }}</h5>
                <p class="card-text text-muted">
                  {{ product.description | slice : 0 : 70 }}...
                </p>
                <div class="d-flex justify-content-between align-items-center">
                  <span class="fs-5 fw-bold text-success">{{
                    product.price | currency : "USD" : "symbol" : "1.2-2"
                  }}</span>
                </div>
              </div>
            </a>
          </div>
        } @empty { }
      </div>
    }

    @if (!isLoading() && totalProducts() > 0) { <div class="d-flex flex-column align-items-center my-4">
        <p class="total-products-info text-white-50 text-center mb-2 fst-italic"> Toplam {{ totalProducts() }} ürün bulundu.
        </p>

        <div class="d-flex justify-content-center flex-wrap gap-3 mb-4">
          <div class="d-flex align-items-center">
            <label for="itemsPerPage" class="form-label text-white me-2 mb-0">Ürün Sayısı:</label>
            <select
              id="itemsPerPage"
              class="form-select form-select-sm bg-secondary text-white border-secondary"
              [ngModel]="itemsPerPage()"
              (change)="onItemsPerPageChange($event)"
            >
              @for (option of itemsPerPageOptions(); track option) {
                <option [value]="option">{{ option }}</option>
              }
            </select>
          </div>

          <div class="d-flex align-items-center">
            <label for="pageJump" class="form-label text-white me-2 mb-0">Sayfaya Git:</label>
            <select
              id="pageJump"
              class="form-select form-select-sm bg-secondary text-white border-secondary"
              [ngModel]="currentPage()"
              (change)="onPageSelectChange($event)"
            >
              @for (page of pageNumbers(); track page) {
                <option [value]="page">Sayfa {{ page }}</option>
              }
            </select>
          </div>
        </div>

        <nav aria-label="Ürün Sayfaları">
          <ul class="pagination">
            <li class="page-item" [class.disabled]="currentPage() === 1">
              <button class="page-link text-white" (click)="prevPage()">Önceki</button>
            </li>
            <li class="page-item disabled">
              <span class="page-link text-white">
                Sayfa {{ currentPage() }} / {{ totalPages() | number : "1.0-0" }}
              </span>
            </li>
            <li
              class="page-item"
              [class.disabled]="currentPage() === totalPages()"
            >
              <button class="page-link text-white" (click)="nextPage()">Sonraki</button>
            </li>
          </ul>
        </nav>
      </div>
    }
  </div>
</div>